#!/bin/bash

# The Red Hat Security Response Team provides OVAL definitions
# for all vulnerabilities(identified by CVE name) that affect RHEL.
# This enables users to perform a vulnerability scan and
# diagnose whether system is vulnerable.

cd /root

# Download latest definitions.
#
wget http://www.redhat.com/security/data/metrics/com.redhat.rhsa-all.xccdf.xml
wget http://www.redhat.com/security/data/oval/com.redhat.rhsa-all.xml

# Run a vulnerability scan.
#
# Store machine-parseable report (XML).
# Store human-readable report (HTML).
#
# Exit status:
# 0 == finished successfully
# 1 == evaluation did not finish
# 2 == finished but system is incompliant
#
checkfile="com.redhat.rhsa-all.xccdf.xml"
outname="vulnerability-report"
oscap xccdf eval --results $outname.xml --report $outname.html $checkfile
